<div class="detailviecquanly-card">
  <i class="fa-regular fa-clipboard"></i>
  <div class="content">
    <div class="task-title">{{ detailViecquanlyModel.Title }}</div>
    <div class="description">
      <button class="desp-button">
        üìÖ
        <ng-container
          *ngIf="
            detailViecquanlyModel.StartDate && detailViecquanlyModel.DueDate;
            else dueDate
          "
        >
          {{ convertDate(detailViecquanlyModel.StartDate) }}
          -
          {{ convertDate(detailViecquanlyModel.DueDate) }}
        </ng-container>
        <ng-template #dueDate>L·ªói th·ªùi h·∫°n</ng-template>
      </button>
      <div class="container-button-assignUser">
        <div
          class="desp-button"
          nz-popover
          nzPopoverTitle="T√™n ng∆∞·ªùi th·ª±c hi·ªán"
          nzPopoverTrigger="click"
          [nzPopoverContent]="contentTemplate"
        >
          üë§ Ng∆∞·ªùi th·ª±c hi·ªán
        </div>
        <ng-template #contentTemplate>
          <ul nz-menu>
            <li
              nz-menu-item
              *ngFor="let item of detailViecquanlyModel.AssigneeFullNames"
            >
              <img
                style="width: 25px; height: 25px; border-radius: 50%"
                src="https://api.dicebear.com/7.x/personas/svg?seed=trinhdongzza"
                alt=""
              />
              {{ item }}
            </li>
            <li
              nz-menu-item
              *ngIf="detailViecquanlyModel.AssigneeFullNames.length == 0"
            >
              Danh s√°ch tr·ªëng
            </li>
          </ul>
        </ng-template>
      </div>
      <div class="container-button-frequency">
        <a nz-dropdown nzTrigger="click" [nzDropdownMenu]="menu">
          <div class="center-flex">
            <ng-container
              *ngIf="
                frequency?.frequency_type != null ||
                  frequency?.frequency_type != '';
                else defaultTag
              "
            >
              <div class="desp-button">
                üìÜ L·ªãch b√°o c√°o theo {{ frequency?.frequency_type }}
              </div>
            </ng-container>
            <ng-template #defaultTag>
              <div class="sub-title">L·ªói hi·ªÉn th·ªã l·ªãch b√°o c√°o</div>
            </ng-template>
          </div>
        </a>
        <nz-dropdown-menu #menu="nzDropdownMenu" #menuRef="nzDropdownMenu">
          <div class="assign-dropdown" nz-menu>
            <app-select-repeat-schedule
              [isEdit]="false"
              [initValue]="frequency"
            ></app-select-repeat-schedule>
          </div>
        </nz-dropdown-menu>
      </div>
      <div class="container-button-desp">
        <div class="desp-button" (click)="showModalDesp()">
          <span> üîç N·ªôi dung </span>
        </div>
      </div>
      <div class="progress-bar">
        <nz-progress
          [nzPercent]="detailViecquanlyModel.PercentageComplete.toFixed(2)"
          nzStatus="active"
        ></nz-progress>
      </div>
    </div>
  </div>
  <div class="viecquanly-actions">
    <div>
      <button
        style="
          background: #40a9ff !important;
          min-width: 112px !important;
          border-color: #40a9ff !important;
        "
        nz-button
        nzType="primary"
        (click)="goReviewPage()"
      >
        R√† so√°t
      </button>
    </div>
    <div class="flex">
      <button
        style="
          background: rgb(0, 156, 0) !important;
          border-color: rgb(0, 156, 0) !important;
          margin-right: 5px;
        "
        nz-button
        nzType="primary"
        class="m-b-10"
        (click)="showModalEdit()"
      >
        S·ª≠a
      </button>
      <button
        style="background: #b51a1d !important; border-color: #b51a1d !important"
        nz-button
        nzType="primary"
        (click)="showInfo()"
      >
        X√≥a
      </button>
    </div>
  </div>
</div>

<app-modal-detail-progress-child-job
  *ngIf="isShowDetailProgressModal"
  [taskId]="detailViecquanlyModel.TaskId.toString()"
  (isShowModal)="toggleShowDetailProgressModal()"
></app-modal-detail-progress-child-job>
<app-modal-detail-despcription-job
  [desp]="detailViecquanlyModel.Description"
></app-modal-detail-despcription-job>
<nz-modal
  [(nzVisible)]="isVisibleModalEdit"
  nzTitle="S·ª≠a c√¥ng vi·ªác"
  (nzOnCancel)="handleCancel()"
  (nzOnOk)="handleEdit()"
  [nzContent]="modalContent"
  [nzFooter]="modalFooter"
>
  <ng-template #modalContent>
    <div class="edit-title m-b-10">
      <div class="flex m-b-10">
        <span class="title">T√™n c√¥ng vi·ªác </span>
        <nz-switch
          [(ngModel)]="isEditTitleTask"
          [nzCheckedChildren]="checkedTemplate"
          [nzUnCheckedChildren]="unCheckedTemplate"
        ></nz-switch>
      </div>

      <div>
        <input
          *ngIf="isEditTitleTask"
          spellcheck="false"
          [(ngModel)]="objectEdit.title"
          class="inline-edit-input"
        />
      </div>
    </div>
    <div class="edit-title m-b-10">
      <div class="flex m-b-10">
        <span class="title">N·ªôi dung c√¥ng vi·ªác </span>
        <nz-switch
          [(ngModel)]="isEditDespTask"
          [nzCheckedChildren]="checkedTemplate"
          [nzUnCheckedChildren]="unCheckedTemplate"
        ></nz-switch>
      </div>
      <div style="flex: 1">
        <textarea
          *ngIf="isEditDespTask"
          nz-input
          placeholder=""
          [(ngModel)]="objectEdit.despcription"
          [nzAutosize]="{ minRows: 3, maxRows: 10 }"
        ></textarea>
      </div>
    </div>
    <!--  -->
    <div class="edit-title">
      <div class="flex m-b-10">
        <div class="title m-b-5">Ch·ªçn th·ªùi h·∫°n</div>
        <nz-switch
          [(ngModel)]="isEditDateTimeTask"
          [nzCheckedChildren]="checkedTemplate"
          [nzUnCheckedChildren]="unCheckedTemplate"
        ></nz-switch>
      </div>
      <nz-range-picker
        *ngIf="isEditDateTimeTask"
        class="m-b-10"
        [nzShowTime]="{ nzFormat: 'HH:mm' }"
        nzFormat="yyyy-MM-dd HH:mm"
        [(ngModel)]="selectedRange"
        (ngModelChange)="onChangeDateModalEdit($event)"
      ></nz-range-picker>
    </div>
    <!--  -->
    <div class="edit-title">
      <div class="flex m-b-10">
        <div class="title m-b-5">Ch·ªçn k·ª≥ b√°o c√°o</div>
        <nz-switch
          [(ngModel)]="isEditFrequencyTask"
          [nzCheckedChildren]="checkedTemplate"
          [nzUnCheckedChildren]="unCheckedTemplate"
        ></nz-switch>
      </div>
      <div>
        <app-modal-assign-schedule
          *ngIf="isEditFrequencyTask"
          (frequencyOutput)="getFrequencySelected($event)"
        ></app-modal-assign-schedule>
      </div>
    </div>
    <!--  -->
    <ng-template #checkedTemplate><nz-icon nzType="check" /></ng-template>
    <ng-template #unCheckedTemplate><nz-icon nzType="close" /></ng-template>
  </ng-template>
  <ng-template #modalFooter>
    <button nz-button nzType="default" (click)="handleCancel()">H·ªßy b·ªè</button>
    <button
      nz-button
      nzType="primary"
      (click)="handleEdit()"
      [nzLoading]="isOkLoading"
    >
      X√°c nh·∫≠n
    </button>
  </ng-template>
</nz-modal>
<!--  -->